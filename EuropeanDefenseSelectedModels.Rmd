---
title: "European Defense and Public Opinion: Selected Models"
author: "Greg Sanders"
date: "October 19, 2015"
output: html_document
---

**Load packages and support files**
```{r Setup, echo = FALSE, results = "hide"}
options(error=recover)
options(warn=1)

require(Hmisc)
require(texreg)
require(plm)
require(ggplot2)
require(reshape2)
require(plyr)
require(quantmod)

#Your working directory here!
# setwd("K:/Development/Europe") #Your working directory here!
#setwd("C:/Users/Greg Sanders/Documents/Development/Europe")
# setwd("C:/Users/scohen/My Documents/Europe/Git/Europe")

source("EuropeInput.R")

```


**Load and subset the data we want**
```{r Input, echo = FALSE, results = "hide"}

EuropeOmnibus <- CompilePubOpDataOmnibus()
EuropeOmnibus <- subset(EuropeOmnibus, !Country %in% c("Greece", "Sweden","Russia","United States"))


```



**load and subset the data we want**
```{r DefSpreadNarrowing, echo = FALSE, results = "hide"}

##load data using function
EquSpread <- subset(EuropeOmnibus, !is.na(EquSpendDelt_lead))
DefSpread <- subset(EuropeOmnibus, !is.na(DefSpendDelt_lead))

EuropeDef_model<-list()
EuropeDef_name<-c()
EuropeEqu_model<-list()
EuropeEqu_name<-c()


```


*Dependent Variable: Defense Spending*
``` {r Hyp1a_Inc_Dec_Defense_and_Defense_Spending, echo = TRUE}

reg<-1
EuropeEqu_model[reg] <- list(lm(DefSpendDelt_lead ~ DefSpread_lag1 + GDPpCapDelt, 
                           data=DefSpread))
summary(EuropeEqu_model[[reg]])

```


``` {r Hyp1b_Inc_Dec_Defense_and_Defense_Spending, echo = TRUE}
reg<-1
EuropeEqu_model[reg] <- list(lm(EquSpendDelt ~ DefSpread_lag2 + GDPpCapDelt + left_right_ls_spread, 
                              data=EquSpread))
summary(EuropeEqu_model[[reg]])


```


``` {r Hyp2a_EU_Leadership_and_Defense_Spending, echo = TRUE}




```

``` {r Hyp2b_EU_Leadership_and_Defense_Spending, echo = TRUE}




```



``` {r Hyp3A, echo = TRUE}
reg<-2
EuropeDef_model[reg] <- list(lm(DefSpendDelt_lead ~ NATOessSpread_lag2, 
                                data=DefSpread))
EuropeDef_name[reg]<-"H3A: NATO EU Def OLS"
summary(EuropeDef_model[[reg]])

reg<-3
EuropeDef_model[reg] <- list(lm(DefSpendDelt_lead ~ NATO.EUspread_lag1  + GDPpCapDelt + liberty_authority_ls_spread, 
                                data=DefSpread))
EuropeDef_name[reg]<-"H3A: NATO Ess Def OLS"
summary(EuropeDef_model[[reg]])

screenreg(EuropeDef_model[c(1:2)],
          custom.model.name=EuropeDef_name[c(1:2)])

```

After comparing the three options, the three year difference between expenditure and Nato Essential polling appears to have the strongest relationship, even if it no where close to significant.


``` {r Hyp3B, echo = TRUE}
reg<-2
EuropeEqu_model[reg] <- list(lm(EquSpendDelt_lead ~ NATO.EUspread_lag2  + GDPpCapDelt + eu_anti_pro_ls_spread, 
                                data=EquSpread))
EuropeEqu_name[reg]<-"H3B: NATO-EU Equ OLS"
summary(EuropeEqu_model[[reg]])
plot(EuropeEqu_model[[reg]])

reg<-3
EuropeEqu_model[reg] <- list(lm(EquSpendDelt_lead ~ NATOessSpread_lag1  + CivilWar, 
                                data=EquSpread))
EuropeEqu_model[reg]<-"H3B: NATO-Ess Equ OLS"
summary(EuropeEqu_model[[reg]])

screenreg(EuropeDef_model[c(1:3)],
          custom.model.name=EuropeDef_name[c(1:3)])

```



