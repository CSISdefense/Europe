---
title: "Europe Regression"
author: "src"
date: "Wednesday, April 08, 2015"
output:
  html_document:
    keep_md: yes
---




**Load packages and support files**
```{r Setup, echo = TRUE }
options(error=recover)
options(warn=1)

require(Hmisc)
require(texreg)
require(plm)
require(ggplot2)

# setwd("C:/Users/scohen/My Documents/Europe/Europe/Europe/") #Your working directory here!
# setwd("K:/Development/Europe") #Your working directory here!
setwd("C:/Users/Greg Sanders/Documents/Development/Europe")
#  setwd("H:/Europe/Git/Europe")

source("EuropeInput.R")

```


**Load and subset the data we want**
```{r Input, echo = TRUE}
debug(CompilePubOpDataOmnibus)
##load data using function
EuropeOmnibus <- CompilePubOpDataOmnibus()
debug(StandardizeCountries)
write.table(EuropeOmnibus
            ,file=paste("data\\EuropeOmnibus.csv"
                        ,sep=""
                        )
            #   ,header=TRUE
            , sep=","
            , row.names=FALSE
            , append=FALSE
            )


#get rid of greece
EuropeOmnibus <- subset(EuropeOmnibus, !Country %in% c("Greece", "Sweden","Russia","United States"))

##get rird of 2002 and 2003
#EuropeOmnibus <- subset(EuropeOmnibus, !Year %in% c("2002", "2003"))


write.table(EuropeOmnibus
            ,file=paste("data\\EuropeSample.csv"
                        ,sep=""
                        )
            #   ,header=TRUE
            , sep=","
            , row.names=FALSE
            , append=FALSE
            )


##lead

# shift<-function(x,shift_by){
#     stopifnot(is.numeric(shift_by))
#     stopifnot(is.numeric(x))
#  
#     if (length(shift_by)>1)
#         return(sapply(shift_by,shift, x=x))
#  
#     out<-NULL
#     abs_shift_by=abs(shift_by)
#     if (shift_by > 0 )
#         out<-c(tail(x,-abs_shift_by),rep(NA,abs_shift_by))
#     else if (shift_by < 0 )
#         out<-c(rep(NA,abs_shift_by), head(x,-abs_shift_by))
#     else
#         out<-x
#     out
# }
# 
# EuropeOmnibus$defSpnd_lead <- shift(EuropeOmnibus$DefSpnd, 1)

##create data frame to test for correlation between variables
EuropeOmnibus<-data.frame(
  Dspend  = EuropeOmnibus$DefSpnd,
  DefSpnd_lead  = EuropeOmnibus$DefSpnd_lead,
  ThreatRatio  = EuropeOmnibus$ThreatRatio,
  IntAt = EuropeOmnibus$IntAt,
  DomAt = EuropeOmnibus$DomAt,
  CivilWar = EuropeOmnibus$CivilWar,
  IntlCnf=  EuropeOmnibus$IntlCnf,
  Population =  EuropeOmnibus$Populationulation,
  GDPpCap = EuropeOmnibus$GDPpCapap,
  Dem = EuropeOmnibus$democ,
  NATO = EuropeOmnibus$NATOally,
  USldrSpread =EuropeOmnibus$USldrSpread,
  DefSpread =EuropeOmnibus$DefSpread,
  Country = EuropeOmnibus$Country,
  Year = EuropeOmnibus$Year
  
)


```

**create data frame to test correlation between variables and test them**
```{r USldrSpread, Correlation, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EuropeOmnibus,select=-c(Country,Year))))

```

**Summary statistics of data**
```{r USldrSpreadSummary, echo = TRUE}

summary(EuropeOmnibus)

```

###US leadership 

**OLS models, adding each variable individually**
```{r USldrSpreadBuilding, echo = TRUE}
USleadResults1 <- lm(log(DefSpnd_lead) ~ USldrSpread, EuropeOmnibus) 
USleadResults2 <- lm(log(DefSpnd_lead) ~ USldrSpread, EuropeOmnibus)
USleadResults3 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt, EuropeOmnibus)
USleadResults4 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt, EuropeOmnibus)
USleadResults5 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar, EuropeOmnibus)
USleadResults6 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf, EuropeOmnibus)
USleadResults7 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population), EuropeOmnibus)
USleadResults8 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap), EuropeOmnibus)
USleadResults9 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem, EuropeOmnibus)
# USleadResults10 <- lm(log(DefSpnd_lead) ~
#     USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
screenreg(list(USleadResults1, USleadResults2, USleadResults3, USleadResults4, USleadResults5, USleadResults6, USleadResults7, USleadResults8, USleadResults9))

USleadResultChosen<-USleadResults9

plot(USleadResultChosen)

```


**Hypothesis testing**

2. F-tests
``` {r USleadSpreadFtest, echo = TRUE}
##For IntAt and GDPpCap
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults1 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults1, ratio = .000001, conf.level = 0.95)
##reject null hypothesis that both of these coefficients are equal to zero

##For CivilWar and DomAt
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults2 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults2, ratio = .000001, conf.level = 0.95)
##reject null hypothesis that both of these coefficients are equal to zero

##For CivilWar and IntlCnf
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults3 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults3, ratio = .000001, conf.level = 0.95)
##Cannot reject the null hypothesis that both of these coefficients are equal to zero.  
#because of this, IntlCnf might not merit inclusion in the model becasue it's statistics show that by itself, it's not statistically significant at the 95% level, it only increases r^2 by .01 when added and it doesn't affect the other variables.  (except a decrease in   by .05 but this is not a huge impact on the model)
#IntlCnf will also be tested with Dem so that f-test will determine it's merit in the model.
##Civil war is already significant with other variables.

##For CivilWar and Dem
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults4 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeOmnibus)
var.test(USleadResultChosen, Hresults4, ratio = .000001, conf.level = 0.95)
##Reject the null hypothesis that both of these coefficients are equal to zero

##For IntlCnf and Dem
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults5 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeOmnibus)
var.test(USleadResultChosen, Hresults5, ratio = .000001, conf.level = .95)
##reject the null hypothesis that  both of these coefficients are equal to zero
##This means that the above uncertainty of IntlCnf's significance is resolved and IntlCnf should stay in the model

##For GDPpCap and CivilWar
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults6 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + IntlCnf + log(Population) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults6, ratio = .000001, conf.level = .95)
##reject the null hypothesis that both of these coefficients are equal to zero

##For Dem and USldrSpread
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults7 <- lm(log(DefSpnd_lead) ~   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) , EuropeOmnibus)
var.test(USleadResultChosen, Hresults7, ratio = .000001, conf.level = .95)
## reject the null hypothesis that both of these coefficients are equal to zero

##For CivilWar and USldrSpread
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults8 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults8, ratio = .000001, conf.level = .95)
##reject the null hypothesis that both of these coefficients are equal to zero

##for USldrSpread and Dem
USleadResultChosen <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
Hresults9 <- lm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeOmnibus)
var.test(USleadResultChosen, Hresults9, ratio = .000001, conf.level = .95)
##reject the null hypothesis that both of these coefficients are equal to zero


```


**Fixed effects model**
```{r USleaderFixedEffects, echo = TRUE}

Bresults1 <- plm(log(DefSpnd_lead) ~ USldrSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , data=EuropeOmnibus, index=c("Country", "Year"), model="within")
summary(Bresults1)
#plot(Bresults1)

#Comparing OLS to fixed effects model and testing for fixed effects
screenreg(list(USleadResultChosen, Bresults1))

pFtest(Bresults1, USleadResultChosen)


```


###Country spending too much or too little on defense data --> defense spending

**load and subset the data we want**
```{r DefSpreadNarrowing, echo = TRUE}

##load data using function
EuropeDefSpread <- subset(EuropeOmnibus, !is.na(DefSpread))

#EuropeDefSpread <- subset(EuropeDefSpread,!Country %in% c("EU 10","EU 7","USA","EU 11","EU 9","EU 12","EU 8"))

##need to make this for years greater than 2004
#EuropeDefSpread <- subset(EuropeDefSpread, !Year %in% c("2002", "2003"))

##get rid of sweden
EuropeDefSpread <- subset(EuropeDefSpread, !Country %in% c("Sweden", "Serbia", "Bulgaria", "Romania"))


```

**summary statistics of data**
```{r DefSpreadSummary, echo = TRUE}

##Summary statistics of data
summary(EuropeDefSpread)

```

**create data frame to test correlation between variables and test them**
```{r DefSpreadCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EuropeDefSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r DefSpreadOLS, echo = TRUE}
EUDefSpreadResults1 <- lm(log(DefSpnd_lead) ~ DefSpread, EuropeDefSpread) 
screenreg(list(EUDefSpreadResults1))

EUDefSpreadResults3 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt, EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3))

##IntAt increases r^2 to .09 and is significant 95% will be included

EUDefSpreadResults4 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt, EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults4))

##DomAt is not statistically significant nor does it change r^2 or any other coefficient. will not be included

EUDefSpreadResults5 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + CivilWar, EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults5))
summary(EUDefSpreadResults5)
##CivilWar is not significant, doesn't affect other coefficients (except sign of defspread but that's zero so doesn't matter really) and increases r^2 by .01 - will not be included.

EUDefSpreadResults6 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + IntlCnf, EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults6))
summary(EUDefSpreadResults6)

##IntlCnf does not change other coefficients significantly, is not significant and only increases r^2 by .01 - will not be included.

EUDefSpreadResults7 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + log(Population), EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults7))
summary(EUDefSpreadResults7)

##log population increases r^2 by .5, is significant at the .001% level, keeps def spread -0.00. will be included in the model. 

EUDefSpreadResults8 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), EuropeDefSpread)
screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults7, EUDefSpreadResults8))
summary(EUDefSpreadResults8)

##gdppc increases r^2 by .21, which can potentially be bad. it also increases the significant of def spread to .05%, is itself significant at the .001 level. will be included. 

##NEED GOV'T VARIABLE
EUDefSpreadResults9 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), EuropeDefSpread)


screenreg(list(EUDefSpreadResults1, EUDefSpreadResults3, EUDefSpreadResults4, EUDefSpreadResults5, EUDefSpreadResults6, EUDefSpreadResults7, EUDefSpreadResults8, EUDefSpreadResults9))

plot(EUDefSpreadResults10)

```


**Hypothesis testing**
``` {r DefSpreadTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```

**Tests of within and pooling** we should explain this in the 

``` {r defspreadPoolingTest, echo = TRUE}

DefSpreadPooled <- plm(log(DefSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, model = "pooling")

DefSpreadWithin <- plm(log(DefSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), data =  EuropeDefSpread, model = "within")

pFtest(DefSpreadWithin, DefSpreadPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model** (within)
```{r DefSpreadFixed, echo = TRUE}

EUDefSpreadResultsA <- plm(log(DefSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, index=c("Country", "Year"), model="within") 
summary(EUDefSpreadResultsA)

screenreg(list(EUDefSpreadResults9, EUDefSpreadResultsA))

#testing for fixed effects
pFtest(EUDefSpreadResultsA, EUDefSpreadResults9)

```

**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r DefSperadHausmanTest, echo = TRUE}

EUDefSpreadResultsWithin <- plm(log(DefSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, index=c("Country", "Year"), model="within") 

EUDefSpreadResultsRandom <- plm(log(DefSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, index=c("Country", "Year"), model="random")

phtest(EUDefSpreadResultsWithin, EUDefSpreadResultsRandom)
##p - 4.45e^-6, reject null and use fixed effects

```



###Country spending too much or too little on defense data --> Investment spending

**load and subset the data we want**
```{r EquSpreadNarrowing, echo = TRUE}

##load data using function
EuropeDefSpread <- subset(EuropeOmnibus, !is.na(DefSpread))

#EuropeDefSpread <- subset(EuropeDefSpread,!Country %in% c("EU 10","EU 7","USA","EU 11","EU 9","EU 12","EU 8"))

##need to make this for years greater than 2004
#EuropeDefSpread <- subset(EuropeDefSpread, !Year %in% c("2002", "2003"))

##get rid of sweden
EuropeDefSpread <- subset(EuropeDefSpread, !Country %in% c("Sweden", "Serbia", "Bulgaria", "Romania"))


```

**summary statistics of data**
```{r EquSpreadSummary, echo = TRUE}

##Summary statistics of data
summary(EuropeDefSpread)

```

**create data frame to test correlation between variables and test them**
```{r EquSpreadCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EuropeDefSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r EquSpreadOLS, echo = TRUE}
EquEUDefSpreadResults1 <- lm(log(EquSpnd_lead) ~ DefSpread, EuropeDefSpread) 
summary(EquEUDefSpreadResults1)

EquEUDefSpreadResults3 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt, EuropeDefSpread)
summary(EquEUDefSpreadResults3)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3))

#IntAt is significant, increases r^2 --> will be inlcuded in model

EquEUDefSpreadResults4 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + DomAt, EuropeDefSpread)
summary(EquEUDefSpreadResults4)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults4))

##DomAt has no effect, is not significant nad doesn't change r^2 -->will not be included

EquEUDefSpreadResults5 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + CivilWar, EuropeDefSpread)
summary(EquEUDefSpreadResults5)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults5))

##CivWar doesn't change other coeficients, increases r^2 by .01, and is not significant thus will not be included in the model. 

EquEUDefSpreadResults6 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + IntlCnf, EuropeDefSpread)
summary(EquEUDefSpreadResults6)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults6))

##IntlCnf does not change anything and is not significant, will not be included

EquEUDefSpreadResults7 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + log(Population), EuropeDefSpread)
summary(EquEUDefSpreadResults7)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults7))

##log(Population) is significant, increases significance of inAt, changes direction of DefSpread and increases r^2 by .6, it will be included

EquEUDefSpreadResults8 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), EuropeDefSpread)
summary(EquEUDefSpreadResults8)
screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults7, EquEUDefSpreadResults8))

##GDPpc is significant, increases r^2 and changes defspread back to positive. will be included.

##NEED GOVERNMENT VARIABLE
EquEUDefSpreadResults9 <- lm(log(EquSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), EuropeDefSpread)

screenreg(list(EquEUDefSpreadResults1, EquEUDefSpreadResults3, EquEUDefSpreadResults7, EquEUDefSpreadResults8, EquEUDefSpreadResults9))


plot(EquEUDefSpreadResults10)

```


**Hypothesis testing**
``` {r EquSpreadTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```

**Tests of within and pooling** we should explain this in the appendix 

``` {r EquSpreadpooledTest, echo = TRUE}

EquDefSpreadPooled <- plm(log(EquSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, model = "pooling")

EquDefSpreadWithin <- plm(log(EquSpnd_lead) ~ DefSpread + IntAt + log(Population) + log(GDPpCap), data =  EuropeDefSpread, model = "within")

pFtest(EquDefSpreadWithin, EquDefSpreadPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r EquSpreadFixed, echo = TRUE}

EquEUDefSpreadResultsA <- plm(log(EquSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data=EuropeDefSpread, index=c("Country", "Year"), model="within") 
summary(EquEUDefSpreadResultsA)

screenreg(list(EquEUDefSpreadResults10, EquEUDefSpreadResultsA))


```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r EquDefSperadHausmanTest, echo = TRUE}

EquEUDefSpreadResultsWithin <- plm(log(EquSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, index=c("Country", "Year"), model="within") 

EquEUDefSpreadResultsRandom <- plm(log(EquSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EuropeDefSpread, index=c("Country", "Year"), model="random")

phtest(EquEUDefSpreadResultsWithin, EquEUDefSpreadResultsRandom)
##p - 1.592e^-07, reject null and use fixed effects

```


###How desirable is it that the EU exert strong leadership in world affairs? Defense Spending

**load and subset the data we want**
```{r EUexertLeadershipNarrowing, echo = TRUE}

##load data using function
EULeadershipSpread <- subset(EuropeOmnibus, !is.na(EUldrSpread))


##get rid of Serbia
EULeadershipSpread <- subset(EULeadershipSpread, !Country %in% c("Serbia"))


```

**summary statistics of data**
```{r EULeadershipSpreadSummary, echo = TRUE}

##Summary statistics of data
summary(EULeadershipSpread)

```

**create data frame to test correlation between variables and test them**
```{r EULeadershipSpreadCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EULeadershipSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r EULeadershipspreadRegressions, echo = TRUE}
EULeadershipResults1 <- lm(log(DefSpnd_lead) ~ EUldrSpread, EULeadershipSpread) 
summary(EULeadershipResults1)
screenreg(list(EULeadershipResults1))

EULeadershipResults2 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt, EULeadershipSpread)
summary(EULeadershipResults2)
screenreg(list(EULeadershipResults1, EULeadershipResults2))

##increases r^2 is signficant will be kept

EULeadershipResults3 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + DomAt, EULeadershipSpread)
summary(EULeadershipResults3)
screenreg(list(EULeadershipResults1, EULeadershipResults2, EULeadershipResults3))

#not significnat will not include

EULeadershipResults4 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + CivilWar, EULeadershipSpread)
summary(EULeadershipResults4)
screenreg(list(EULeadershipResults1, EULeadershipResults2, EULeadershipResults4))

##not significant or impacting, will not include

EULeadershipResults5 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + IntlCnf, EULeadershipSpread)
summary(EULeadershipResults5)
screenreg(list(EULeadershipResults1, EULeadershipResults2, EULeadershipResults5))

##no effect not significant, will not include 

EULeadershipResults6 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + log(Population), EULeadershipSpread)
summary(EULeadershipResults6)
screenreg(list(EULeadershipResults1, EULeadershipResults2, EULeadershipResults6))

##significant, increases r^2 will be included

EULeadershipResults8 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), EULeadershipSpread)
summary(EULeadershipResults8)
screenreg(list(EULeadershipResults1, EULeadershipResults2, EULeadershipResults6, EULeadershipResults8))

##significant, increases r^2 but, it decreases significance and sign on EUldrSpread, should be discussed.....

##edit government variable
EULeadershipResults10 <- lm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap), EULeadershipSpread)


```


**Hypothesis testing**
``` {r EULeadershipspreadTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```


**Tests of within and pooling** we should explain this in the appendix 

``` {r EULeadershippooledTest, echo = TRUE}

EULeadershipPooled <- plm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, model = "pooling")

EULeadershipWithin <- plm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), data =  EULeadershipSpread, model = "within")

pFtest(EULeadershipWithin, EULeadershipPooled )
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r EULeadershipspreadFixed, echo = TRUE}

EULeadershipResultsA <- plm(log(DefSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), EULeadershipSpread, index=c("Country", "Year"), model="within") 
summary(EULeadershipResultsA)

screenreg(list(EULeadershipResults8, EULeadershipResultsA))

pFtest(EULeadershipResultsA, EULeadershipResults8)

```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r EquDefSperadHausmanTest, echo = TRUE}

EULeadershipResultsWithin <- plm(log(DefSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, index=c("Country", "Year"), model="within") 

EULeadershipResultsRandom <- plm(log(DefSpnd_lead) ~ DefSpread +  IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, index=c("Country", "Year"), model="random")

phtest(EULeadershipResultsWithin, EULeadershipResultsRandom)
##p - 3.439e^-08, reject null and use fixed effects

```




###How desirable is it that the EU exert strong leadership in world affairs? Investment SPending

**load and subset the data we want**
```{r EUleadEquipNarrowing, echo = TRUE}

##load data using function
EULeadershipSpread <- subset(EuropeOmnibus, !is.na(EUldrSpread))


##get rid of Serbia
EULeadershipSpread <- subset(EULeadershipSpread, !Country %in% c("Serbia"))



```

**summary statistics of data**
```{r EUleadEquipSpreadSummary, echo = TRUE}

##Summary statistics of data
summary(EULeadershipSpread)

```

**create data frame to test correlation between variables and test them**
```{r EUleadEquipSpreadCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EULeadershipSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r EUleadEquipspreadRegressions, echo = TRUE}
InvEULeadResults1 <- lm(log(EquSpnd_lead) ~ EUldrSpread, EULeadershipSpread) 
summary(InvEULeadResults1)
screenreg(list(InvEULeadResults1))

InvEULeadResults2 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt, EULeadershipSpread)
summary(InvEULeadResults2)
screenreg(list(InvEULeadResults1, InvEULeadResults2))

InvEULeadResults3 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + DomAt, EULeadershipSpread)
summary(InvEULeadResults3)
screenreg(list(InvEULeadResults1, InvEULeadResults2, InvEULeadResults3))

##DomAt is not significant nor does it change r^2 will not be included.

InvEULeadResults4 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + CivilWar, EULeadershipSpread)
summary(InvEULeadResults4)
screenreg(list(InvEULeadResults1, InvEULeadResults2, InvEULeadResults4))

##CivilWar doesn't increase r^2 and is not significant, will not be included

InvEULeadResults5 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + IntlCnf, EULeadershipSpread)
summary(InvEULeadResults5)
screenreg(list(InvEULeadResults1, InvEULeadResults2, InvEULeadResults5))

##IntlCnf is not significant and doesn't increase r^2, thus will not be included

InvEULeadResults6 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population), EULeadershipSpread)
summary(InvEULeadResults6)
screenreg(list(InvEULeadResults1, InvEULeadResults2, InvEULeadResults6))

##log(Population) is significant and increases r^2, will be included

InvEULeadResults7 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), EULeadershipSpread)
summary(InvEULeadResults7)
screenreg(list(InvEULeadResults1, InvEULeadResults2, InvEULeadResults6, InvEULeadResults7))

## increases r^2, is significant and increases significance on other variables, will be included

##when government variable updated add!
InvEULeadResults8 <- lm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), EULeadershipSpread)


plot(EULeadershipResults8)

```


**Hypothesis testing**
``` {r EUleadEquipspreadTesting, echo = TRUE}
# 
# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)

##reject the null hypothesis that these two variables are equal to zero. 
```


**Tests of within and pooling** we should explain this in the appendix 

``` {r EULeadershipEquipspreadpooledTest, echo = TRUE}

InvEULeadPooled <- plm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, model = "pooling")

InvEULeadWithin <- plm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), data =  EULeadershipSpread, model = "within")
summary(InvEULeadWithin)

pFtest(InvEULeadWithin, InvEULeadPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r EUleadEquipspreadFixed, echo = TRUE}

InvEULeadResultsA <- plm(log(EquSpnd_lead) ~ EUldrSpread + IntAt + log(Population) + log(GDPpCap), EULeadershipSpread, index=c("Country", "Year"), model="within") 
summary(InvEULeadResultsA)

screenreg(list(InvEULeadResults7, InvEULeadResultsA))


```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r EquDefSperadHausmanTest, echo = TRUE}

InvEULeadWithin <- plm(log(EquSpnd_lead) ~ EUldrSpread +  IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, index=c("Country", "Year"), model="within") 

InvEULeadRandom <- plm(log(EquSpnd_lead) ~ EUldrSpread +  IntAt + log(Population) + log(GDPpCap), data = EULeadershipSpread, index=c("Country", "Year"), model="random")

screenreg(list(InvEULeadWithin, InvEULeadRandom))

phtest(InvEULeadWithin, InvEULeadRandom)
##p - 9.25ee^-05, reject null and use fixed effects

```



###Is NATO still essential to your country's secuirty? and Defense Spending

**load and subset the data we want**
```{r NATOEssentialNarrowing, echo = TRUE}

##load data using function
NATOEssentialSpread <- subset(EuropeOmnibus, !is.na(NATOessSpread))


##get rid of 2014
NATOEssentialSpread <- subset(NATOEssentialSpread, !Year %in% c("2014"))



```

**summary statistics of data**
```{r NATOEssentialSummary, echo = TRUE}

##Summary statistics of data
summary(NATOEssentialSpread)

```

**create data frame to test correlation between variables and test them**
```{r NATOEssentialCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(NATOEssentialSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r NATOEssentialRegressions, echo = TRUE}
NATOEssResults1 <- lm(log(DefSpnd_lead) ~ NATOessSpread, NATOEssentialSpread) 
summary(NATOEssResults1)
screenreg(list(NATOEssResults1))

NATOEssResults2 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt, NATOEssentialSpread)
summary(NATOEssResults2)
screenreg(list(NATOEssResults1, NATOEssResults2))

##intAT increases r^2 and is significant will be included

NATOEssResults3 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + DomAt, NATOEssentialSpread)
summary(NATOEssResults3)
screenreg(list(NATOEssResults1, NATOEssResults2, NATOEssResults3))

##DomAt isn't significant, doesn't have an effect and doesn't increase r^2, will not be included

NATOEssResults4 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + CivilWar, NATOEssentialSpread)
summary(NATOEssResults4)
screenreg(list(NATOEssResults1, NATOEssResults2, NATOEssResults4))

##doesn't increase r^2, isn't significant and doesn't have an effect on the other variables, will not be included

NATOEssResults5 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + IntlCnf, NATOEssentialSpread)
summary(NATOEssResults5)
screenreg(list(NATOEssResults1, NATOEssResults2, NATOEssResults5))

##doesn't increase r^2, isn't significant and doesn't have an effect on the other variables, will not be included

NATOEssResults6 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population), NATOEssentialSpread)
summary(NATOEssResults6)
screenreg(list(NATOEssResults1, NATOEssResults2, NATOEssResults6))

##Increases r^2, is significant, increases the value and significance on NATOessspread, decreases value and significance of IntAt, will be included


NATOEssResults7 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), NATOEssentialSpread)
summary(NATOEssResults7)
screenreg(list(NATOEssResults1, NATOEssResults2, NATOEssResults6, NATOEssResults7))

##increases significane, is significant, increase r^2, will be included

##add government variable!

NATOEssResults8 <- lm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap), NATOEssentialSpread)


plot(NATOEssentialResults8)

```


**Hypothesis testing**
``` {r NATOEssentialTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```


**Tests of within and pooling** we should explain this in the appendix 

``` {r NATOEssentialpooledTest, echo = TRUE}

NATOEssResultsPooled <- plm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, model = "pooling")

NATOEssResultsWithin <- plm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data =  NATOEssentialSpread, model = "within")
summary(NATOEssResultsWithin)

pFtest(NATOEssResultsWithin, NATOEssResultsPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```



**Fixed Effects model**
```{r NATOEssentialFixed, echo = TRUE}

NATOEssResultsA <- plm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), NATOEssentialSpread, index=c("Country", "Year"), model="within") 
summary(NATOEssResultsA)

screenreg(list(NATOEssResults7, NATOEssResultsA))

pFtest(NATOEssResultssA, NATOEssResults7)

```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r NATOEssentialHausmanTest, echo = TRUE}

NATOEssResultsWithin <- plm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="within") 

NATOEssResultsRandom <- plm(log(DefSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="random")

screenreg(list(NATOEssResultsWithin, NATOEssResultsRandom))

phtest(NATOEssResultsWithin, NATOEssResultsRandom)
##p - .00436, possibly accept null and use random effects because random effects yields better results..

```



###Is NATO still essential to your country's secuirty? and Investment Spending

**load and subset the data we want**
```{r NATOEssentialNarrowing_EquSpnd_lead, echo = TRUE}

##load data using function
NATOEssentialSpread <- subset(EuropeOmnibus, !is.na(NATOessSpread))


##get rid of 2014
NATOEssentialSpread <- subset(NATOEssentialSpread, !Year %in% c("2014"))


```

**summary statistics of data**
```{r NATOEssentialSummary_EquSpnd_lead, echo = TRUE}

##Summary statistics of data
summary(NATOEssentialSpread)

```

**create data frame to test correlation between variables and test them**
```{r NATOEssentialCorr_EquSpnd_lead, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(NATOEssentialSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r NATOEssentialRegressions_EquSpnd_lead, echo = TRUE}
InvNATOEssResults1 <- lm(log(EquSpnd_lead) ~ NATOessSpread, NATOEssentialSpread)
summary(InvNATOEssResults1)
screenreg(list(InvNATOEssResults1))

InvNATOEssResults2 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt, NATOEssentialSpread)
summary(InvNATOEssResults2)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2))

##significnat, in creases r^2, will be included

InvNATOEssResults3 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt +DomAt, NATOEssentialSpread)
summary(InvNATOEssResults3)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2, InvNATOEssResults3))

##no impact, doesn't increase r^2, will not be included

InvNATOEssResults4 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + CivilWar, NATOEssentialSpread)
summary(InvNATOEssResults4)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2, InvNATOEssResults4))

##not significant, doesn't affect other variables greatly, will not be included


InvNATOEssResults5 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + IntlCnf, NATOEssentialSpread)
summary(InvNATOEssResults5)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2, InvNATOEssResults5))

##doesn't change adjusted r^2, is not significant, will not be included


InvNATOEssResults6 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population), NATOEssentialSpread)
summary(InvNATOEssResults6)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2, InvNATOEssResults6))

##significant, increases r^2, will be included


InvNATOEssResults7 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), NATOEssentialSpread)
summary(InvNATOEssResults7)
screenreg(list(InvNATOEssResults1, InvNATOEssResults2, InvNATOEssResults6, InvNATOEssResults7))

##increases significance, is significant, increases r^2, will be included

##need government variable!

NATOEssentialResults8 <- lm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap), NATOEssentialSpread)



plot(NATOEssentialResults10)

```


**Hypothesis testing**
``` {r NATOEssentialTesting_EquSpnd_lead, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)

##reject the null hypothesis that these two variables are equal to zero. 
```


``` {r InvestmentSpendingNATOEssentialpooledTest, echo = TRUE}

InvNATOEssResultsPooled <- plm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, model = "pooling")

InvNATOEssResultsWithin <- plm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data =  NATOEssentialSpread, model = "within")
summary(InvNATOEssResultsWithin)

pFtest(InvNATOEssResultsWithin, InvNATOEssResultsPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r InvestmentSpendingNATOEssentialFixedEquSpnd_lead, echo = TRUE}

InvNATOEssentialResultsA <- plm(log(EquSpnd_lead) ~ NATOessSpread  + IntAt + log(Population) + log(GDPpCap), NATOEssentialSpread, index=c("Country", "Year"), model="within") 
summary(InvNATOEssentialResultsA)

screenreg(list(InvNATOEssResults7, InvNATOEssentialResultsA))

pFtest(InvNATOEssentialResultsA, InvNATOEssResults7)

```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r InvestmentSpendingNATOEssentialHausmanTest, echo = TRUE}

InvNATOEssResultsWithin <- plm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="within") 

InvNATOEssResultsRandom <- plm(log(EquSpnd_lead) ~ NATOessSpread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="random")

screenreg(list(InvNATOEssResultsWithin, InvNATOEssResultsRandom))

phtest(InvNATOEssResultsWithin, InvNATOEssResultsRandom)
##p = 1.014e^-11, possibly accept null and use random effects because random effects yields better results..

```



##EU and NATO should be closer or more independent?


**load and subset the data we want**
```{r EUnNATOCloseNarrowing, echo = TRUE}

##load data using function
EUnNATOCloseSpread <- subset(EuropeOmnibus, !is.na(NATO.EUspread))

##get rid of Serbia and Turkey
EUnNATOCloseSpread <- subset(EUnNATOCloseSpread, !Country %in% c("Serbia", "Turkey"))

#get rid of 2014
EUnNATOCloseSpread <- subset(EUnNATOCloseSpread, !Year %in% c("2014"))


```

**summary statistics of data**
```{r EUnNATOCloseSummary, echo = TRUE}

##Summary statistics of data
summary(EUnNATOCloseSpread)

```

**create data frame to test correlation between variables and test them**
```{r EUnNATOCloseCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EUnNATOCloseSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r EUnNATOCloseRegressions, echo = TRUE}
EUnNATOCloseResults1 <- lm(log(DefSpnd_lead) ~ NATO.EUspread, EUnNATOCloseSpread) 
summary(EUnNATOCloseResults1)
screenreg(list(EUnNATOCloseResults1))

EUnNATOCloseResults2 <- lm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt, EUnNATOCloseSpread)
summary(EUnNATOCloseResults2)
screenreg(list(EUnNATOCloseResults1, EUnNATOCloseResults2))

##increases r^2, is significant, will be included

EUnNATOCloseResults3 <- lm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + DomAt, EUnNATOCloseSpread)
summary(EUnNATOCloseResults3)
screenreg(list(EUnNATOCloseResults1, EUnNATOCloseResults2, EUnNATOCloseResults3))

##DomAt is not meaningful and will not be included

EUnNATOCloseResults4 <- lm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population), EUnNATOCloseSpread)
summary(EUnNATOCloseResults4)
screenreg(list(EUnNATOCloseResults1, EUnNATOCloseResults2, EUnNATOCloseResults4))

##is significant, increases r^2, will be included

EUnNATOCloseResults5 <- lm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), EUnNATOCloseSpread)
summary(EUnNATOCloseResults5)
screenreg(list(EUnNATOCloseResults1, EUnNATOCloseResults2, EUnNATOCloseResults4, EUnNATOCloseResults5))

##need government variable

EUnNATOCloseResults6 <- lm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + DomAt + CivilWar + IntlCnf, EUnNATOCloseSpread)



plot(EUnNATOCloseSpreadResults10)

```


**Hypothesis testing**
``` {r EUnNATOCloseTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```


``` {r EUnNATOClosePooledTest, echo = TRUE}

EUnNATOPooled <- plm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), data = EUnNATOCloseSpread, model = "pooling")

EUnNATOWithin <- plm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), data =  EUnNATOCloseSpread, model = "within")
summary(EUnNATOWithin)

pFtest(EUnNATOWithin, EUnNATOPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r EUnNATOCloseFixed, echo = TRUE}

EUnNATOCloseResultsA <- plm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), EUnNATOCloseSpread, index=c("Country", "Year"), model="within") 
summary(EUnNATOCloseSpreadResultsA)

screenreg(list(EUnNATOCloseResults5, EUnNATOCloseResultsA))

pFtest(EUnNATOCloseResultsA, EUnNATOCloseResults5)


```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r EUnNATOCloseResultsHausmanTest, echo = TRUE}

EUnNATOCloseResultsWithin <- plm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="within") 

EUnNATOCloseResultsRandom <- plm(log(DefSpnd_lead) ~ NATO.EUspread + IntAt + log(Population) + log(GDPpCap), data = NATOEssentialSpread, index=c("Country", "Year"), model="random")

screenreg(list(EUnNATOCloseResultsWithin, EUnNATOCloseResultsRandom))

phtest(EUnNATOCloseResultsWithin, EUnNATOCloseResultsRandom)
##p = 1.52e^-09, possibly accept null and use random effects because random effects yields better results..

```



### EU Favorability


**load and subset the data we want**
```{r EUfvrSpreadNarrowing, echo = TRUE}

##load data using function
EUfvrdata <- subset(EuropeOmnibus, !is.na(EUfvrSpread))


##get rid of Serbia 
EUfvrdata <- subset(EUfvrSpread, !Country %in% c("Serbia"))

#get rid of 2014
EUfvrdata <- subset(EUfvrSpread, !Year %in% c("2014"))



```

**summary statistics of data**
```{r EUfvrSpreadSpreadSummary, echo = TRUE}

##Summary statistics of data
summary(EUfvrSpread)

```

**create data frame to test correlation between variables and test them**
```{r EUfvrSpreadSpreadCorr, echo = TRUE}

##Test correlation between variables 
rcorr(as.matrix(subset(EUfvrSpread,select=-c(Country,Year))))

```



**OLS model adding each variable individually**
```{r EUfvrSpreadRegressions, echo = TRUE}
EUfvrSpreadResults1 <- lm(log(DefSpnd_lead) ~ EUfvrSpread, EUfvrdata) 
screenreg(list(EUfvrSpreadResults1))

EUfvrSpreadResults2 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt, EUfvrdata)
summary(EUfvrSpreadResults2)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2))

##IntAt increases r^2 and is significant, will be included

EUfvrSpreadResults3 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + DomAt, EUfvrdata)
summary(EUfvrSpreadResults3)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2, EUfvrSpreadResults3))

##not significant, doesn't increase r^2, won't be included

EUfvrSpreadResults4 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar, EUfvrdata)
summary(EUfvrSpreadResults4)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2, EUfvrSpreadResults4))

##civilwar is significant , increases r^2 by .11, will be included


EUfvrSpreadResults5 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population), EUfvrdata)
summary(EUfvrSpreadResults5)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2, EUfvrSpreadResults4, EUfvrSpreadResults5))

##log(Population) is significant, increases r^2 ans will be included


EUfvrSpreadResults6 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + IntlCnf + log(Population), EUfvrdata)
summary(EUfvrSpreadResults6)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2, EUfvrSpreadResults4, EUfvrSpreadResults5, EUfvrSpreadResults6))

##intlcnf doesn't increase r^2, is not significant and won't be inlcuded in the model

EUfvrSpreadResults7 <- lm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), EUfvrdata)
summary(EUfvrSpreadResults7)
screenreg(list(EUfvrSpreadResults1, EUfvrSpreadResults2, EUfvrSpreadResults4, EUfvrSpreadResults5, EUfvrSpreadResults7))

##will be included


##need government variable!!
EUfvrSpreadResults8 <- lm(log(DefSpnd_lead) ~ EUfvrSpread  + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap), EUfvrSpread)



plot(EUfvrSpreadResultsResults10)

```


**Hypothesis testing**
``` {r EUfvrSpreadTesting, echo = TRUE}

# ##  and GDPpCap
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults1 <- lm(log(DefSpnd_lead) ~ DefSpread + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults1, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##DomAt and CivilWar
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults2 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults2, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and IntlCnf
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults3 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults3, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##CivilWar and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults4 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + IntlCnf + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults4, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##IntrWr and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults5 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + log(Population) + log(GDPpCap) , EuropeDefSpread)
# var.test(Cresults10, Gresults5, ratio = .000001, conf.level = .95)
# ##reject the null hypothesis that these two variables are equal to zero
# 
# ##Population and Dem
# Cresults10 <- lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# Gresults6 <-  lm(log(DefSpnd_lead) ~ DefSpread +   + IntAt + DomAt + CivilWar + IntlCnf + log(Population) + log(GDPpCap) + Dem , EuropeDefSpread)
# var.test(Cresults10, Gresults6, ratio = .000001, conf.level = .95)
# 
# ##reject the null hypothesis that these two variables are equal to zero. 
```


``` {r EUFvrPooledTest, echo = TRUE}

EUFvrPooled <- plm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), data = EUfvrdata, model = "pooling")

EUFvrWithin <- plm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), data =  EUfvrdata, model = "within")
summary(EUFvrWithin)

pFtest(EUFvrWithin, EUFvrPooled)
##p <2.2e^-16 thus reject the null that the pooling model works (all coefficients for each country should be the same ever year)

```


**Fixed Effects model**
```{r EUfvrSpreadFixed, echo = TRUE}

EUfvrResultsA <- plm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), EUfvrdata, index=c("Country", "Year"), model="within") 
summary(EUfvrResultsA)

screenreg(list(EUfvrSpreadResults7, EUfvrResultsA))

pFtest(EUfvrResultsA, EUfvrSpreadResults7)

```


**Compare Fixed effects to random effects** Hausman test. null hypothesist that RE model is true, alternative = fixed effects model
``` {r EUfvrHausmanTest, echo = TRUE}

EUfvrWithin <- plm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), data = EUfvrdata, index=c("Country", "Year"), model="within") 

EUfvrRandom <- plm(log(DefSpnd_lead) ~ EUfvrSpread + IntAt + CivilWar + log(Population) + log(GDPpCap), data = EUfvrdata, index=c("Country", "Year"), model="random")

screenreg(list(EUfvrWithin, EUfvrRandom))

phtest(EUfvrWithin, EUfvrRandom)
##p = 2.2e^-16 possibly accept null and use random effects because random effects yields better results..

```

